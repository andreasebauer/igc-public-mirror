<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Simulations — Start</title>
  <link rel="stylesheet" href="/static/style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div>
        <h1>Simulations</h1>
        <p class="muted">Create, edit, run, or sweep simulations. Start by choosing one action below.</p>
      </div>
      <div></div>
    </div>

    <!-- TOP: selection matrix -->
    <div class="card">
      <div class="matrix">
        <!-- Row 1 -->
        <div class="row">
          <div class="cell-btn">
            <button class="btn btn--secondary btn-block" type="button" data-mode="run" id="btn-run"> Run Simulation </button>
          </div>
          <div class="cell-desc">
            <strong>Select Simulation</strong><br>
            Run an existing simulation with optional run-time overrides. DB record stays unchanged; overrides are stored near Frame 0.
          </div>
        </div>
        <!-- Row 2 -->
        <div class="row">
          <div class="cell-btn">
            <button class="btn btn--secondary btn-block" type="button" data-mode="edit" id="btn-edit"> Edit Simulation </button>
          </div>
          <div class="cell-desc">
            <strong>Edit Simulation</strong><br>
            Open a saved simulation, review all fields, and update the spec.
          </div>
        </div>
        <!-- Row 3 -->
        <div class="row">
          <div class="cell-btn">
            <button class="btn btn--secondary btn-block" type="button" data-mode="create" id="btn-create"> New Simulation </button>
          </div>
          <div class="cell-desc">
            <strong>Create Simulation</strong><br>
            Start from defaults to define a new simulation spec; run immediately or later.
          </div>
        </div>
        <!-- Row 4 -->
        <div class="row">
          <div class="cell-btn">
            <button class="btn btn--secondary btn-block" type="button" data-mode="sweep" id="btn-sweep"> Sweep Simulation </button>
          </div>
          <div class="cell-desc">
            <strong>Sweep Simulation</strong><br>
            Choose a base simulation and specify parameter ranges (D, C, λ, thresholds) to enqueue many runs.
          </div>
        </div>
      </div>
    </div>

    <!-- BOTTOM: action bar (separate two-column box) -->
    <div class="card actions">
      <div class="actions-left">
        <a class="btn btn--secondary btn--lg" href="/">Back</a>
      </div>
      <div class="actions-right">
        <a class="btn btn--primary btn--lg" id="btn-next" href="#" aria-disabled="true">Next</a>
      </div>
    </div>
  </div>

  <script>
  (function(){
    const buttons = Array.from(document.querySelectorAll('button[data-mode]'));
    const next = document.getElementById('btn-next');
    let selected = null;

    const routeFor = (mode) => {
      if (mode === 'run')    return '/sims/select?mode=run';
      if (mode === 'edit')   return '/sims/select?mode=edit';
      if (mode === 'sweep')  return '/sims/select?mode=sweep';
      if (mode === 'create') return '/sims/edit?mode=create';
      return '#';
    };

    const paint = () => {
      buttons.forEach(b => b.classList.toggle('btn-primary', b.dataset.mode === selected));
      if (selected) {
        next.setAttribute('href', routeFor(selected));
        next.setAttribute('aria-disabled', 'false');
      } else {
        next.setAttribute('href', '#');
        next.setAttribute('aria-disabled', 'true');
      }
    };

    buttons.forEach(b => b.addEventListener('click', () => { selected = b.dataset.mode; paint(); }));
    paint();
  })();
  </script>
</body>
</html>
